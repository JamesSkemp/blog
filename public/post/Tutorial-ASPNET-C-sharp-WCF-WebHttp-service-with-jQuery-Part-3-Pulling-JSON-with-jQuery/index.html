<!DOCTYPE html>
<html lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Hugo 0.17" />
    <title>Tutorial: ASP.NET (C#) WCF WebHttp service with jQuery: Part 3 - Pulling JSON with jQuery &middot; James Skemp&#39;s StrivingLife</title>
    
    
    
    <meta name="description" content="In this tutorial, leading up to a WCF WebHttp service that can be queried with jQuery, we complete our tutorial by modifying the WCF service to return JSON data to jQuery requests, and output that information to users." />
    <meta name="keywords" content='asp.net,.net,c#,wcf webhttp,rest,jquery,json' />
    <meta name="author" content="" />
    <link href="http://words.strivinglife.com/index.xml" rel="alternate" type="application/rss+xml" title="James Skemp&#39;s StrivingLife" />
    <link rel="stylesheet" href="http://words.strivinglife.com/css/bootstrap.min.css" />
    <link rel="stylesheet" href="http://words.strivinglife.com/css/highlightjs-themes/androidstudio.css" />
    <link rel="stylesheet" href="http://words.strivinglife.com/css/font-awesome.min.css" />
    <link rel="stylesheet" href="http://words.strivinglife.com/css/phlat.css" />
</head>

    <body>
        <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://words.strivinglife.com/">James Skemp&#39;s StrivingLife</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="http://words.strivinglife.com/">
                            Home
                        </a>
                    </li>
                
                    <li>
                        <a href="http://strivinglife.com/Words/Feed">
                            Subscribe
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</nav>

        <div id="top" class="container">
            <div class="row" id="content-main">
                <div class="col-md-8">
                    <div class="row">
    <div class="col-md-12 content-card">
        <h1>Tutorial: ASP.NET (C#) WCF WebHttp service with jQuery: Part 3 - Pulling JSON with jQuery</h1>
        
            
            <ul class="list-inline meta">
                <li><i class="fa fa-calendar"></i>June 25, 2010</li>
                <li><i class="fa fa-user"></i>
					
					James Skemp
					
				</li>
                <li><i class="fa fa-folder"></i><a href="http://words.strivinglife.com/categories/tutorials-/-guides">tutorials / guides</a></li>
            </ul>
        
        <p><div class="note">
<p>See the <a href="http://strivinglife.com/words/post/Tutorial-ASPNET-C-sharp-WCF-WebHttp-service-with-jQuery-Table-of-Contents.aspx">table of contents</a> for more information.</p>
</div>
<p>In this series we&rsquo;ve started with a new loan class, that contains information about a loan, including the total amount due, how much is to be paid per payment, the interest rate, and etcetera. A method is available that will generate information about the number of payments required to pay off the loan.</p>
<p>In the second part we created a WCF WebHttp service, or a WCF REST service, to use the class/assembly from that loan object and return XML data for GET requests.</p>
<p>In this final part we&rsquo;ll be using jQuery to request information from the service, in JSON format, and display that information to users.</p>
<h3>Why JSON?</h3>
<p>For maximum flexibility, and because I myself will be hosting the services on their own domain/sub-domain, we&rsquo;ll be taking advantage of jQuery&rsquo;s ability to make JSONP - JSON with Padding - requests, allowing us to pull data, no matter what our domain.</p>
<h3>Getting started with jQuery</h3>
<p>jQuery is such an advanced library that I can&rsquo;t cover much in this article. See <a rel="external" href="http://jquery.com/">the official jQuery site</a> for more information, including tutorials. For our purposes you&rsquo;ll want to download a copy of&nbsp;jQuery 1.4.2 (or whatever the current release is, assuming things haven&rsquo;t changed too terribly since the time of this writing) for production.</p>
<p>We&rsquo;ll then create a very simple HTML page that we&rsquo;ll modify for our tutorial.</p>
<pre class="code"><code class="xml">&lt;!DOCTYPE html PUBLIC &ldquo;-//W3C//DTD XHTML 1.0 Transitional//EN&rdquo; &ldquo;<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</a>
&lt;html xmlns=&ldquo;<a href="http://www.w3.org/1999/xhtml&quot;&gt;">http://www.w3.org/1999/xhtml&quot;&gt;</a>
&lt;head&gt;
    &lt;title&gt;Test page&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id=&ldquo;pulledData&rdquo;&gt;
    &lt;/div&gt;
&lt;script type=&ldquo;text/javascript&rdquo; src=&ldquo;<a href="http://media.jamesrskemp.com/js/jquery-1.4.2.min.js&quot;&gt;&lt;/script&gt;">http://media.jamesrskemp.com/js/jquery-1.4.2.min.js&quot;&gt;&lt;/script&gt;</a>
&lt;script type=&ldquo;text/javascript&rdquo;&gt;
    function processData(data) {
        try {
            // JavaScript will go either here - in the <em>function</em>
        } catch (ex) {
            alert(&ldquo;Error: &ldquo; + ex.Message);
        }
    }</p>

<pre><code>try {
    if ($) {
        // or JavaScript will go here - in the *request*
    }
} catch (ex) {
    alert(&quot;Error: &quot; + ex.Message);
}
</code></pre>

<p>&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h3>Verifying the service can be called with jQuery, on the same domain</h3>
<p>With our base jQuery file, let&rsquo;s verify the Web service, by making a simple request for a loan: <a href="http://localhost:49821/FormulasService/Loan?name=asdf&amp;total=4956.24&amp;payment=97.85&amp;yearlyPayments=12&amp;yearlyInterest=4.25">http://localhost:49821/FormulasService/Loan?name=asdf&amp;total=4956.24&amp;payment=97.85&amp;yearlyPayments=12&amp;yearlyInterest=4.25</a> (remember to change the port as needed). Assuming this is running fine, which it should be, we can move onto attempting to query this with jQuery.</p>
<p>In the same project as the above service, add our base html file, from above, and add the following to the second block, making sure that the port is correct.</p>
<pre class="code"><code class="javascript">$.ajax({
    type: &ldquo;GET&rdquo;,
    url: &lsquo;<a href="http://localhost:49821/FormulasService/Loan?name=asdf&amp;total=4956.24&amp;payment=97.85&amp;yearlyPayments=12&amp;yearlyInterest=4.25'">http://localhost:49821/FormulasService/Loan?name=asdf&amp;total=4956.24&amp;payment=97.85&amp;yearlyPayments=12&amp;yearlyInterest=4.25'</a>,
    dataType: &lsquo;xml&rsquo;,
    success: function (data) { processData(data); }
});</code></pre>
<p>Then add the following to the function.</p>
<pre class="code"><code class="javascript">alert(&lsquo;hey&rsquo;);</code></pre>
<p>So in our first block we&rsquo;re calling the service once the page is ready, and our function on success. The function then gives a very simple alert, so we easily know that the call has succeeded. If we run this on the same domain (localhost and a port), we should get the alert message. However, opening it by itself (by double-clicking on it in Windows Explorer) will result in no messages at all.</p>
<p>Let&rsquo;s tweak this now to use JSON instead. Tweak the second block so that the dataType line is as follows.</p>
<pre class="code"><code class="javascript">dataType: &lsquo;json&rsquo;,</code></pre>
<p>In our function, add, or replace the existing alert, with the following:</p>
<pre class="code"><code class="javascript">alert(&lsquo;Loan name: &lsquo; + data.Name);</code></pre>
<p>Depending upon the name you&rsquo;ve given the loan, you should see an alert message in Chrome or Firefox, with that name. However, if we now try to open this from a different domain, or just via Windows Explorer, we&rsquo;ll see that our loan name is undefined. If we were to look at the response returned from the service, we&rsquo;d see it&rsquo;s blank.</p>
<h3>JSONP</h3>
<p>Now let&rsquo;s update the dataType once again.</p>
<pre class="code"><code class="javascript">dataType: &lsquo;jsonp&rsquo;,</code></pre>
<p>Refresh now and nothing happens, on anything. However, if we were to take a look at the response we&rsquo;d see that in fact something is returned, it just happens to be XML, which doesn&rsquo;t help us here. And if we switch the dataType to xml, now we can&rsquo;t use it cross-domain (not to mention we lose out on JSON).</p>
<h3>The fix</h3>
<p>The fix, found after hours of research and changing settings, requires modifications to our service.</p>
<p>First, let&rsquo;s change the dataType back to JSONP. Since our request no longer passed application/json as an accept-header, the Web service returns the default format, which happens to be XML, which in turn means nothing works. But we can switch the default format type.</p>
<p>Open Web.config in the service and modify the lone standardEndpoint element to the following.</p>
<pre class="code"><code class="xml">&lt;standardEndpoint name=&ldquo;&rdquo; helpEnabled=&ldquo;true&rdquo; automaticFormatSelectionEnabled=&ldquo;true&rdquo; defaultOutgoingResponseFormat=&ldquo;Json&rdquo;/&gt;</code></pre>
<p>The important part is the new attribute at the end. Build the service and test it again and you&rsquo;ll find that the jQuery called from the same server now works, while the jQuery from a different domain does not.</p>
<p>So we&rsquo;re close, but not quite there.</p>
<h3>Localhost no longer</h3>
<p>Unfortunately, this is where we can no longer test locally. The missing item is the crossDomainScriptAccessEnabled attribute on the standardEndpoint element.</p>
<pre class="code"><code class="xml">&lt;standardEndpoint name=&ldquo;&rdquo; helpEnabled=&ldquo;true&rdquo; automaticFormatSelectionEnabled=&ldquo;true&rdquo; defaultOutgoingResponseFormat=&ldquo;Json&rdquo; crossDomainScriptAccessEnabled=&ldquo;true&rdquo;/&gt;</code></pre>
<p>Since we&rsquo;re authenticated, however, this will horribly fail, which can be shown by just browsing to the service via <a href="http://localhost:49821/FormulasService/Loan?name=asdf&amp;total=4956.24&amp;payment=97.85&amp;yearlyPayments=12&amp;yearlyInterest=4.25">http://localhost:49821/FormulasService/Loan?name=asdf&amp;total=4956.24&amp;payment=97.85&amp;yearlyPayments=12&amp;yearlyInterest=4.25</a> and getting a message&nbsp;that &ldquo;Cross domain javascript callback is not supported in authenticated services.&rdquo;</p>
<p>If you have a server that supports it, go ahead and build the service and push it, with those two new attributes. If you don&rsquo;t, change your jQuery url so that it points to services.jamesrskemp.com, and change the name parameter to your email. (Obviously, if you&rsquo;ve pushed the service to your own server, go ahead and use your domain in place of mine.)</p>
<div class="note">
<p>Update: Of course, we can also switch off authentication and be able to access this via localhost again. Just add the following to your Web.config within the System.Web element.</p>
<pre class="code"><code class="xml">&lt;authentication mode=&ldquo;None&rdquo;/&gt;</code></pre>
</div>
<p>With that done you can now refresh either the copy on the same domain, or a local copy, and have the service return the loan name passed.</p>
<p>Now we can modify our function as follows, to get a semi-nice output:</p>
<pre class="code"><code class="javascript">var outputContent = &ldquo;&rdquo;;
outputContent += &ldquo;Loan name: &ldquo; + data.Name + &ldquo;&lt;br /&gt;&rdquo;;
outputContent += &ldquo;Starting balance: &ldquo; + data.Total + &ldquo;&lt;br /&gt;&rdquo;;
$.each(data.Payments, function (i, payment) { outputContent += &ldquo;After a payment of &rdquo; + payment.Total + &ldquo;, the remaining amount is $&rdquo; + payment.LoanRemaining + &ldquo;&lt;br /&gt;&rdquo;;});
$(&lsquo;#pulledData&rsquo;).html(outputContent);</code></pre>
<p>You can <a rel="external" href="http://media.jamesrskemp.com/articles/ServiceExamples/FormulasService_Loan.htm">see this in action</a>&nbsp;on my media sub-domain,&nbsp;with possible improvements after this article is finished.</p>
<p>And with that, you should have more than enough information to get cracking on your own services, with your own jQuery implementations.</p></p>

        
    <ul class="list-inline tags" style="margin-top: 15px; margin-left: 0px">
        
            <li style=""><a href="http://words.strivinglife.com/tags/asp.net">asp.net</a></li>
        
            <li style=""><a href="http://words.strivinglife.com/tags/.net">.net</a></li>
        
            <li style=""><a href="http://words.strivinglife.com/tags/c">c#</a></li>
        
            <li style=""><a href="http://words.strivinglife.com/tags/wcf-webhttp">wcf webhttp</a></li>
        
            <li style=""><a href="http://words.strivinglife.com/tags/rest">rest</a></li>
        
            <li style=""><a href="http://words.strivinglife.com/tags/jquery">jquery</a></li>
        
            <li style=""><a href="http://words.strivinglife.com/tags/json">json</a></li>
        
    </ul>


    </div>
</div>

                    
    
        <div class="row">
            <div class="col-md-12 content-card">
                <div id="disqus_thread"></div>
                <script>
                    (function() {
                        if (window.location.hostname == "localhost") {
                            document.write("Disqus comments are unavailable while serving on localhost or 127.0.0.1");
                            return;
                        }
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        var disqus_shortname = 'strivinglife';
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
    


                </div>
                <div class="col-md-4">
                    <div class="row">
    <div class="col-md-11 col-md-offset-1 card">
        <h5>Search</h5>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
            <div class="input-group">
                <input class="form-control" type="search" name="q" />
                <span class="input-group-btn">
                    <button class="btn btn-custom" type="submit"><span class="glyphicon glyphicon-search"></span></button>
                </span>
            </div>
            <input type="hidden" name="q" value="site:http://words.strivinglife.com/">
        </form>
    </div>
</div>

                    <div class="row">
	<div class="col-md-11 col-md-offset-1 card">
		<h5>Links of Note</h5>
		<ul class="list-unstyled">
			<li>
				<a href="http://strivinglife.com/waking-life-transcript-with-revisions/">Waking Life</a>
			</li>
			<li>
				<a href="http://strivinglife.com/ghost-in-the-shell-script/">Ghost in the Shell</a>
			</li>
			<li>
				<a href="http://strivinglife.com/ghost-in-the-shell-2-innocence-script/">Ghost in the Shell 2</a>
			</li>
		</ul>
	</div>
</div>
                    <div class="row">
    <div class="col-md-11 col-md-offset-1 card">
        <h5>Recent Posts</h5>
        <ul class="list-unstyled posts-recent">
            <ul class="list-unstyled posts-recent">
                
                    <li><a href="http://words.strivinglife.com/post/review-bissell-2001-hard-floor-expert-cordless-canister/">Review: Bissell 2001 Hard Floor Expert Cordless Canister</a></li>
                
                    <li><a href="http://words.strivinglife.com/post/review-grifters-dystopian-universe/">Review: Grifters</a></li>
                
                    <li><a href="http://words.strivinglife.com/post/review-onitama-board-game/">Review: Onitama</a></li>
                
                    <li><a href="http://words.strivinglife.com/post/review-kanagawa-game/">Review: Kanagawa</a></li>
                
                    <li><a href="http://words.strivinglife.com/post/review-unusual-suspects-board-game/">Review: Unusual Suspects Board Game</a></li>
                
            </ul>
        </ul>
    </div>
</div>

                    <div class="row">
	<div class="col-md-11 col-md-offset-1 card">
		<ins class="adsbygoogle"
			style="display:block"
			data-ad-client="ca-pub-3526066001929698"
			data-ad-slot="3689523691"
			data-ad-format="auto">
		</ins>
	</div>
</div>

                    
    
        <div class="row">
            <div class="col-md-11 col-md-offset-1 card">
                <h5>categories</h5>
                <ul class="list-unstyled posts-recent">
                    
                        <li><a href="http://words.strivinglife.com/categories/review">review</a></li>
                    
                        <li><a href="http://words.strivinglife.com/categories/software">software</a></li>
                    
                        <li><a href="http://words.strivinglife.com/categories/article">article</a></li>
                    
                        <li><a href="http://words.strivinglife.com/categories/strivinglife">strivinglife</a></li>
                    
                        <li><a href="http://words.strivinglife.com/categories/philosophy">philosophy</a></li>
                    
                        <li><a href="http://words.strivinglife.com/categories/tutorials-/-guides">tutorials-/-guides</a></li>
                    
                        <li><a href="http://words.strivinglife.com/categories/dvd-/-movie">dvd-/-movie</a></li>
                    
                        <li><a href="http://words.strivinglife.com/categories/internet">internet</a></li>
                    
                        <li><a href="http://words.strivinglife.com/categories/gaming">gaming</a></li>
                    
                        <li><a href="http://words.strivinglife.com/categories/technology">technology</a></li>
                    
                </ul>
            </div>
        </div>
    

    


                    
	<div class="row">
		<div class="col-md-11 col-md-offset-1 card">
			<h5>Support This Site</h5>
			<p>
				If my blog was helpful to you, then please consider visiting my
				<a href="http://amzn.to/22xk0cK" rel="external">Amazon Wishlist</a>.
			</p>
		</div>
	</div>

                </div>
            </div>
        </div>
        <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-8 col-xs-6">
    <ul class="list-inline links">
        
    </ul>
</div>

            <div class="col-md-4 col-xs-6">
    <ul class="list-inline social-media">
        
        
        
        
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-md-12">
				<p>
					All content copyright 1999-2016 James Skemp, unless otherwise noted.
					This work is licensed under the Creative Commons License <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Attribution-Noncommercial-No Derivative Works 3.0</a>.
					The opinions expressed herein are my own personal opinions and do not represent my employer's view in anyway. <a href="http://strivinglife.com/privacy_policy.html">Privacy Policy</a>.
					For more information, contact the administrator at strivinglife [at] gmail [dot] com.
				</p>
                <p>
                    Generated using <a href="https://gohugo.io/" rel="external">Hugo</a> and the <a href="https://github.com/nraboy/hugo-phlat-theme" rel="external">Phlat Theme</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

        <div id="back-to-top" class="hidden">
    <a href="#top" class="well well-sm" onclick="$('html,body').animate({scrollTop:0},'slow');return false;">
        <i class="glyphicon glyphicon-chevron-up"></i> Back to Top
    </a>
</div>
<script src="http://words.strivinglife.com/js/jquery-2.2.1.min.js"></script>
<script src="http://words.strivinglife.com/js/bootstrap.min.js"></script>
<script src="http://words.strivinglife.com/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>
    if(($(window).height() + 100) < $(document).height()) {
        $('#back-to-top').removeClass('hidden').affix({
            offset: {
                top: 100
            }
        });
    }
</script>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
    
    if (window.location.hostname == "localhost") {
        $(".adsbygoogle").css("text-decoration", "none");
        $(".adsbygoogle").text("Adsense is unavailable while serving on localhost or 127.0.0.1");
    } else {
        [].forEach.call(document.querySelectorAll('.adsbygoogle'), function() {
            (adsbygoogle = window.adsbygoogle || []).push({});
        });
    }
</script>

    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-541034-4', 'auto');
        ga('send', 'pageview');
    </script>



    </body>
</html>
