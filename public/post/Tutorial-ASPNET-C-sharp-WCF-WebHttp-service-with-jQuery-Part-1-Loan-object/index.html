<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="Hugo 0.15" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel='stylesheet' href='//fonts.googleapis.com/css?family=Open+Sans|Marcellus+SC'>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_dark.min.css">
    <link rel="stylesheet" href="http://jamesskemp.github.io/words/css/styles.css">
    <link rel="stylesheet" href="http://jamesskemp.github.io/words/css/custom.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://jamesskemp.github.io/words//index.xml">

    
    <title>Tutorial: ASP.NET (C#) WCF WebHttp service with jQuery: Part 1 - Loan object - James Skemp&#39;s Test Hugo-Generated Site</title>
    <meta property='og:title' content="Tutorial: ASP.NET (C#) WCF WebHttp service with jQuery: Part 1 - Loan object - James Skemp&#39;s Test Hugo-Generated Site">
    <meta property="og:type" content="article">
    

    <meta property="og:url" content="http://jamesskemp.github.io/words/post/Tutorial-ASPNET-C-sharp-WCF-WebHttp-service-with-jQuery-Part-1-Loan-object/">
    
    

  </head>

  <body>

    <header class="site">
      <nav class="navbar navbar-default">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://jamesskemp.github.io/words/">James Skemp&#39;s Test Hugo-Generated Site</a>
          </div>

          <div id="navbar" class="collapse navbar-collapse">
            
          </div>

        </div>
      </nav>
    </header>

    <div class="site">
      <div class="container">



<div class="single">

  <div class="row">
    <div class="col-md-8">

      <article class="single" itemscope="itemscope" itemtype="http://schema.org/Article">

        <meta itemprop="mainEntityOfPage"  itemType="https://schema.org/WebPage" content="http://jamesskemp.github.io/words/"/>
        <meta itemprop="dateModified" content="2010-06-22T21:15:00-05:00">
        <meta itemprop="headline" content="Tutorial: ASP.NET (C#) WCF WebHttp service with jQuery: Part 1 - Loan object">
        <meta itemprop="description" content="See the table of contents for more information. As already noted in the table of contents, the end goal will to have a service that returns enough information to be able to generate an amortization&nbsp;schedule for a loan. I&rsquo;m not in financial services, and haven&rsquo;t been very good in math since some point in high school, but this seems to work fairly well. The first thing we&rsquo;re going to do is generate an assembly that we&rsquo;ll then use in the WCF WebHttp service.">
        <meta itemprop="url" content="http://jamesskemp.github.io/words/post/Tutorial-ASPNET-C-sharp-WCF-WebHttp-service-with-jQuery-Part-1-Loan-object/">
        <div itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
          <meta itemprop="url" content="http://jamesskemp.github.io/words/images/default.jpg" />
          <meta itemprop="width" content="800">
          <meta itemprop="height" content="800">
        </div>
        <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
          <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
            <meta itemprop="url" content="http://jamesskemp.github.io/words/images/logo.jpg">
            <meta itemprop="width" content="100">
            <meta itemprop="height" content="100">
          </div>
          <meta itemprop="name" content="James Skemp&#39;s Test Hugo-Generated Site">
        </div>
        <div itemprop="author" itemscope itemtype="https://schema.org/Person">
          <meta itemprop="name" content="">
        </div>

        <header class="article-header">
          <time itemprop="datePublished" pubdate="pubdate" datetime="2010-06-22T21:15:00-05:00">Tue, Jun 22, 2010</time>
          <h1 class="article-title">Tutorial: ASP.NET (C#) WCF WebHttp service with jQuery: Part 1 - Loan object</h1>
        </header>

        <div class="article-body" itemprop="articleBody">
          <p><div class="note">
<p>See the <a href="http://strivinglife.com/words/post/Tutorial-ASPNET-C-sharp-WCF-WebHttp-service-with-jQuery-Table-of-Contents.aspx">table of contents</a> for more information.</p>
</div>
<p>As already noted in the table of contents, the end goal will to have a service that returns enough information to be able to generate an amortization&nbsp;schedule for a loan. I&rsquo;m not in financial services, and haven&rsquo;t been very good in math since some point in high school, but this seems to work fairly well.</p>
<p>The first thing we&rsquo;re going to do is generate an assembly that we&rsquo;ll then use in the WCF WebHttp service. We&rsquo;ll then create a service that works with this, and finally the jQuery to get information out of the service and display it.</p>
<h3>Defining the loan object</h3>
<p>A loan consists of a total amount due, an amount paid per payment, the number of payments made&nbsp; and the interest rate, per year. While not necessary, since we may want multiple loans to be available at once, we&rsquo;ll also say that loans can have a name, or description.</p>
<p>While Decimal may be better, that gives us something like this for our class.</p>
<pre class="code"><code class="csharp">using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;</p>

<p>namespace JamesRSkemp.Formulas {
    public class Amortization {</p>

<pre><code>    /// &amp;lt;summary&amp;gt;
    /// Loan, with a total amount due, payment amount, number of payments per year, and interest rate per year.
    /// &amp;lt;/summary&amp;gt;
    public class Loan {
        /// &amp;lt;summary&amp;gt;
        /// Name of the loan.
        /// &amp;lt;/summary&amp;gt;
        public String Name { get; set; }
        /// &amp;lt;summary&amp;gt;
        /// Total amount due on the loan.
        /// &amp;lt;/summary&amp;gt;
        public Double Total { get; set; }
        /// &amp;lt;summary&amp;gt;
        /// The amount paid per payment.
        /// &amp;lt;/summary&amp;gt;
        public Double PaymentAmount { get; set; }
        /// &amp;lt;summary&amp;gt;
        /// The number of payments made per year. Usually 12.
        /// &amp;lt;/summary&amp;gt;
        public int PaymentsPerYear { get; set; }
        /// &amp;lt;summary&amp;gt;
        /// Percent of interest, per year.
        /// &amp;lt;/summary&amp;gt;
        public Double InterestPerYear { get; set; }
        /// &amp;lt;summary&amp;gt;
        /// List of individual payments. Only populated/updated by UpdatePayments method.
        /// &amp;lt;/summary&amp;gt;
        public List&amp;lt;Payment&amp;gt; Payments { get; set; }

        /// &amp;lt;summary&amp;gt;
        /// Creates a new instance of a loan. By default sets the number of payments per year to 12.
        /// &amp;lt;/summary&amp;gt;
        public Loan() {
            this.PaymentsPerYear = 12;
        }
    }
}
</code></pre>

<p>}</code></pre>
<p>You&rsquo;ll notice that I&rsquo;m setting the number of payments per year to 12 when the object is initialized, as most loans tend to follow that.</p>
<p>We have payments defined separately, which I&rsquo;ve defined as follows.</p>
<pre class="code"><code class="csharp">/// &lt;summary&gt;
/// Loan payment.
/// &lt;/summary&gt;
public class Payment {
    /// &lt;summary&gt;
    /// Total payment amount.
    /// &lt;/summary&gt;
    public Double Total { get; set; }
    /// &lt;summary&gt;
    /// Amount of payment applied to interest.
    /// &lt;/summary&gt;
    public Double Interest { get; set; }
    /// &lt;summary&gt;
    /// Amount of payment applied to the principal.
    /// &lt;/summary&gt;
    public Double Principal { get; set; }
    /// &lt;summary&gt;
    /// Amount of the loan remaining after this payment is made.
    /// &lt;/summary&gt;
    public Double LoanRemaining { get; set; }
    /// &lt;summary&gt;
    /// New loan payment.
    /// &lt;/summary&gt;
    public Payment() {
    }
}</code></pre>
<p>You can see that I&rsquo;ve assumed a payment will have a total amount paid, with what amount went towards interest and what towards the principal. For tracking ease, I&rsquo;ve also put the loan&rsquo;s remaining amount on the payment as well, although this isn&rsquo;t really necessary. Of course, we don&rsquo;t have a date associated with the payment (which might be a good idea for expansion purposes), so perhaps it is.</p>
<p>Now we have to come up with some way to populate the payments. For this purpose I&rsquo;ve added a method to Loan object which allows the payments to be populated, or updated.</p>
<pre class="code"><code class="csharp">/// &lt;summary&gt;
/// Updates payments on a loan.
/// &lt;/summary&gt;
/// &lt;returns&gt;If payments cannot be updated, returns false.&lt;/returns&gt;
public Boolean UpdatePayments() {
    Boolean paymentsUpdated = false;</p>

<pre><code>if (this.Payments == null) {
    this.Payments = new List&amp;lt;Payment&amp;gt;();
} else {
    this.Payments.Clear();
}

// Determine how much interest should be applied per payment.
Double interestPerPayment = (this.InterestPerYear / 100) / this.PaymentsPerYear;

// Store how much we need to pay. In this case, what the first payment will be.
Double periodPaymentAmount = interestPerPayment * this.Total;

if (periodPaymentAmount &amp;gt;= this.PaymentAmount) {
    throw new Exception(&quot;The amount of interest on the first payment is greater than the amount that will be paid.&quot;);
} else {
    Double totalRemaining = this.Total;

    while (totalRemaining &amp;gt; 0) {
        Payment currentPayment = new Payment();
        currentPayment.Total = this.PaymentAmount;
        currentPayment.Interest = Math.Round(totalRemaining * interestPerPayment, 2);
        currentPayment.Principal = Math.Round(currentPayment.Total - currentPayment.Interest, 2);
        currentPayment.LoanRemaining = Math.Round(totalRemaining - currentPayment.Principal, 2);
                    // If we now have a remaining amount on the loan less than 0, we've paid too much.

        if (currentPayment.LoanRemaining &amp;lt; 0) {
            currentPayment.Total += currentPayment.LoanRemaining;
            currentPayment.Principal += currentPayment.LoanRemaining;
            currentPayment.LoanRemaining = 0;
        }

        this.Payments.Add(currentPayment);

        totalRemaining = currentPayment.LoanRemaining;
        currentPayment = null;
    }
    paymentsUpdated = true;
}

return paymentsUpdated;
</code></pre>

<p>}</code></pre>
<p>You can see that this clears any existing payment information, then loops through and generates a list of payments, which are then associated with the loan. In case the remaining amount due is less than 0, we take that from the payment amount and principal paid to zero the loan.</p>
<h3>Testing this out</h3>
<p>At this point you&rsquo;re more than willing to create a simple command-line client that references this assembly. You can also grab a copy of <a rel="external download" href="http://media.jamesrskemp.com/articles/JamesRSkemp.Formulas.Amortization.cs.txt">JamesRSkemp.Formulas.Amortization</a> online, and compare results with a slightly different version that I use in my <a rel="external" href="http://jamesrskemp.com/testing/asp.net/Amortization.aspx">amortization schedule generator</a>.</p>
<h3>Next time &hellip;</h3>
<p>Now that we have this assembly ready we can look at the next piece, which will be to generate the WCF WebHttp service that actually makes use of this.</p></p>

        </div>


        <aside>
          <div class="section"><a href="http://jamesskemp.github.io/words/tags/asp.net" class="tag">asp.net</a> <a href="http://jamesskemp.github.io/words/tags/.net" class="tag">.net</a> <a href="http://jamesskemp.github.io/words/tags/c#" class="tag">c#</a> </div>

          <div class="section share">
            <a href="http://www.facebook.com/sharer.php?src=bm&u=http%3a%2f%2fjamesskemp.github.io%2fwords%2fpost%2fTutorial-ASPNET-C-sharp-WCF-WebHttp-service-with-jQuery-Part-1-Loan-object%2f&t=Tutorial%3a%20ASP.NET%20%28C%23%29%20WCF%20WebHttp%20service%20with%20jQuery%3a%20Part%201%20-%20Loan%20object" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-facebook"></i></a>
            <a href="http://twitter.com/intent/tweet?url=http%3a%2f%2fjamesskemp.github.io%2fwords%2fpost%2fTutorial-ASPNET-C-sharp-WCF-WebHttp-service-with-jQuery-Part-1-Loan-object%2f&text=Tutorial%3a%20ASP.NET%20%28C%23%29%20WCF%20WebHttp%20service%20with%20jQuery%3a%20Part%201%20-%20Loan%20object&tw_p=tweetbutton" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-twitter"></i></a>
            <a href="https://plus.google.com/share?url=http%3a%2f%2fjamesskemp.github.io%2fwords%2fpost%2fTutorial-ASPNET-C-sharp-WCF-WebHttp-service-with-jQuery-Part-1-Loan-object%2f" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-google-plus"></i></a>
            <a href="http://getpocket.com/edit?url=http%3a%2f%2fjamesskemp.github.io%2fwords%2fpost%2fTutorial-ASPNET-C-sharp-WCF-WebHttp-service-with-jQuery-Part-1-Loan-object%2f&title=Tutorial%3a%20ASP.NET%20%28C%23%29%20WCF%20WebHttp%20service%20with%20jQuery%3a%20Part%201%20-%20Loan%20object" onclick="window.open(this.href, 'PCwindow', 'width=550, height=350, menubar=no, toolbar=no, scrollbars=yes'); return false;"><i class="fa fa-get-pocket"></i></a>
          </div>

          
          
          
        </aside>

      </article>

    </div>
    <div class="col-md-4">
      
<aside class="site">

  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">LatestPosts</h2>
    </div>
    <div class="list-group">
      
      <a href="http://jamesskemp.github.io/words/post/Review-Amazon-Fire-7-2015-release-Case/" class="list-group-item">Review: Amazon Fire 7 (2015 release) Case</a>
      
      <a href="http://jamesskemp.github.io/words/post/review-alienware-steam-machine-asm100-4980blk-desktop-console/" class="list-group-item">Review: Alienware Steam Machine ASM100-4980BLK Desktop Console (Intel Core i5, 8 GB RAM, 1 TB HDD) NVIDIA GeForce GTX GPU</a>
      
      <a href="http://jamesskemp.github.io/words/post/review-zagg-slim-cover-surface-4-mc3wkk-bb0/" class="list-group-item">Review: ZAGG Slim Cover, Ultra-Slim Bluetooth Tablet Keyboard for Microsoft Surface Pro 3 and 4 (MC3WKK-BB0)</a>
      
      <a href="http://jamesskemp.github.io/words/post/review-sennheiser-hd-471g-headset/" class="list-group-item">Review: Sennheiser HD 471G Headset with Inline Mic and 3 Button Control</a>
      
      <a href="http://jamesskemp.github.io/words/post/Review-Amazon-Fire-HD-8-2015-release-Case/" class="list-group-item">Review: Amazon Fire HD 8 (2015 release) Case</a>
      
      <a href="http://jamesskemp.github.io/words/post/Review-Verso-Fire-7-2015-Case-Sea-Blue-Classic-Slim-Fit-Premium-PU-Leather-Book-Folio-Style-Protective-Case-7-inch-Display-5th-Generation-2015-Release-Only/" class="list-group-item">Review: Verso Fire 7 2015 Case - Sea Blue Classic Slim Fit Premium PU Leather Book Folio Style Protective Case (7 inch Display - 5th Generation, 2015 Release Only)</a>
      
      <a href="http://jamesskemp.github.io/words/post/Review-Fury-of-Dracula-Third-Edition-Board-Game/" class="list-group-item">Review: Fury of Dracula Third Edition Board Game</a>
      
      <a href="http://jamesskemp.github.io/words/post/Setting-up-a-Raspberry-Pi-2-Samba-server-%28in-early-January-2016%29/" class="list-group-item">Setting up a Raspberry Pi 2 Samba server (in early January 2016)</a>
      
      <a href="http://jamesskemp.github.io/words/post/Google-Services-on-the-Amazon-Fire-HD-8/" class="list-group-item">Google Services on the Amazon Fire HD 8</a>
      
      <a href="http://jamesskemp.github.io/words/post/Review-Adonit-Jot-Dash-Fine-Point-Precision-Stylus/" class="list-group-item">Review: Adonit Jot Dash - Fine Point Precision Stylus</a>
      
    </div>
  </div>

  
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">category</h2>
    </div>
    <div class="list-group">
      
      <a href="http://jamesskemp.github.io/words/categories/software" class="list-group-item">software</a>
      
      <a href="http://jamesskemp.github.io/words/categories/article" class="list-group-item">article</a>
      
      <a href="http://jamesskemp.github.io/words/categories/review" class="list-group-item">review</a>
      
      <a href="http://jamesskemp.github.io/words/categories/strivinglife" class="list-group-item">strivinglife</a>
      
      <a href="http://jamesskemp.github.io/words/categories/philosophy" class="list-group-item">philosophy</a>
      
      <a href="http://jamesskemp.github.io/words/categories/tutorials-/-guides" class="list-group-item">tutorials-/-guides</a>
      
      <a href="http://jamesskemp.github.io/words/categories/dvd-/-movie" class="list-group-item">dvd-/-movie</a>
      
      <a href="http://jamesskemp.github.io/words/categories/internet" class="list-group-item">internet</a>
      
      <a href="http://jamesskemp.github.io/words/categories/gaming" class="list-group-item">gaming</a>
      
      <a href="http://jamesskemp.github.io/words/categories/technology" class="list-group-item">technology</a>
      
    </div>
  </div>
  
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">tag</h2>
    </div>
    <div class="list-group">
      
      <a href="http://jamesskemp.github.io/words/tags/review" class="list-group-item">review</a>
      
      <a href="http://jamesskemp.github.io/words/tags/.net" class="list-group-item">.net</a>
      
      <a href="http://jamesskemp.github.io/words/tags/xml" class="list-group-item">xml</a>
      
      <a href="http://jamesskemp.github.io/words/tags/ghost-in-the-shell" class="list-group-item">ghost-in-the-shell</a>
      
      <a href="http://jamesskemp.github.io/words/tags/c" class="list-group-item">c#</a>
      
      <a href="http://jamesskemp.github.io/words/tags/apache" class="list-group-item">apache</a>
      
      <a href="http://jamesskemp.github.io/words/tags/playstation" class="list-group-item">playstation</a>
      
      <a href="http://jamesskemp.github.io/words/tags/microsoft" class="list-group-item">microsoft</a>
      
      <a href="http://jamesskemp.github.io/words/tags/waking-life" class="list-group-item">waking-life</a>
      
      <a href="http://jamesskemp.github.io/words/tags/ipod" class="list-group-item">ipod</a>
      
    </div>
  </div>
  

</aside>


    </div>
  </div>

</div>

      </div>
    </div>

    <footer class="site">
      <div class="container">
        <p>&copy; 2016 James Skemp&#39;s Test Hugo-Generated Site</p>
        <p>Powered by <a href="http://gohugo.io" target="_blank">Hugo</a>,</p>
        <p>Theme <a href="https://github.com/dim0627/hugo_theme_robust" target="_blank">Robust</a> designed by <a href="http://yet.unresolved.xyz" target="_blank">Daisuke Tsuji</a></p>
      </div>
    </footer>

    <script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    

  </body>
</html>

